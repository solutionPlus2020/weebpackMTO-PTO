<?phpnamespace App\Controller;use App\Entity\Fournisseur;use App\Entity\Produits;use App\Form\ProduitsType;use App\Repository\ProduitsRepository;use Doctrine\Common\Persistence\ObjectManager;use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;use Symfony\Component\HttpFoundation\Request;use Symfony\Component\HttpFoundation\Response;use Symfony\Component\Routing\Annotation\Route;/** * @Route("/produits") */class ProduitsController extends AbstractController{    /**     * @Route("/", name="produits_index", methods={"GET"})     *     */    public function index(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/index.html.twig', [            'produits' => $produitsRepository->findAll(),            //'pto' => $this->fetchPTO()        ]);    }    /**     * @Route("/new", name="produits_new", methods={"GET","POST"})     */    public function new(Request $request): Response    {        $produit = new Produits();        $form = $this->createForm(ProduitsType::class, $produit);        $form->handleRequest($request);        if ($form->isSubmitted() && $form->isValid()) {            $entityManager = $this->getDoctrine()->getManager();            $entityManager->persist($produit);            $entityManager->flush();            //$manager->persist($produit);            //$manager->flush();            $this->addFlash(                'success',                "Votre Produit <strong>{$produit->getTitle()}</strong> a bien été enregistrée !"            );            return $this->redirectToRoute('produits_index');        }        return $this->render('produits/new.html.twig', [            'produit' => $produit,            'form' => $form->createView(),        ]);    }    /**     * @Route("/{id}/description", name="produits_description", methods={"GET"})     */    public function showP(Produits $produit): Response    {        return $this->render('produits/test.html.twig', [            'descriptions' => $produit->getDescriptions(),            'images' => $produit->getImages(),        ]);    }    /**     * @Route("/{id}", name="produits_show", methods={"GET"})     */    public function show(Produits $produit): Response    {        return $this->render('produits/show.html.twig', [            'test'=>'pto',            'produit' => $produit,            'images' => $produit->getImages(),            'descriptions' => $produit->getDescriptions()        ]);    }    /**     * @Route("/{id}/image", name="produits_images", methods={"GET"})     */    public function showImages(Produits $produit): Response    {        return $this->render('produits/image.html.twig', [            'images' => $produit->getImages(),        ]);    }    /**     * @Route("/{id}/edit", name="produits_edit", methods={"GET","POST"})     */    public function edit(Request $request, Produits $produit): Response    {        $form = $this->createForm(ProduitsType::class, $produit);        $form->handleRequest($request);        if ($form->isSubmitted() && $form->isValid()) {            $this->getDoctrine()->getManager()->flush();            return $this->redirectToRoute('produits_index');        }        return $this->render('produits/edit.html.twig', [            'produit' => $produit,            'form' => $form->createView(),        ]);    }    /**     * @Route("/{id}", name="produits_delete", methods={"DELETE"})     */    public function delete(Request $request, Produits $produit): Response    {        if ($this->isCsrfTokenValid('delete' . $produit->getId(), $request->request->get('_token'))) {            $entityManager = $this->getDoctrine()->getManager();            $entityManager->remove($produit);            $entityManager->flush();        }        return $this->redirectToRoute('produits_index');    }    /**     * @Route("/PTO/prestations", name="produits_PTO", methods={"GET"})     *     */    public function PTO(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/fournisseur.html.twig', [            'test'=>'pto',            'produits' => $this->getDoctrine()->getRepository(Produits::class)->findByFournisseur(2),            'circuits' => $this->getDoctrine()->getRepository(Produits::class)->findByFourPres(2, 1),            'sejours' => $this->getDoctrine()->getRepository(Produits::class)->findByFourPres(2, 2),            'weekends' => $this->getDoctrine()->getRepository(Produits::class)->findByFourPres(2, 3)        ]);    }    /**     * @Route("/PTO/prestationSejours", name="sejours_PTO", methods={"GET"})     *     */    public function PTOsejours(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/fournisseur.html.twig', [            'test'=>'pto',            'produits' => $this->getDoctrine()->getRepository(Produits::class)->findByFournisseur(2),            'circuits' => '',            'sejours' => $this->getDoctrine()->getRepository(Produits::class)->findByFourPres(2, 2),            'weekends' => ''        ]);    }    /**     * @Route("/PTO/prestationCircuits", name="circuits_PTO", methods={"GET"})     *     */    public function PTOcircuit(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/fournisseur.html.twig', [            'test'=>'pto',            'produits' => $this->getDoctrine()->getRepository(Produits::class)->findByFournisseur(2),            'circuits' => $this->getDoctrine()->getRepository(Produits::class)->findByFourPres(2, 1),            'sejours' => '',            'weekends' => ''        ]);    }    /**     * @Route("/PTO/prestationWeekEnd", name="Weekends_PTO", methods={"GET"})     *     */    public function PTOWeekend(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/fournisseur.html.twig', [            'test'=>'pto',            'produits' => $this->getDoctrine()->getRepository(Produits::class)->findByFournisseur(2),            'circuits' => '',            'sejours' => '',            'weekends' => $this->getDoctrine()->getRepository(Produits::class)->findByFourPres(2, 3)        ]);    }    /**     * @Route("/MTO/prestation", name="produits_MTO", methods={"GET"})     *     */    public function MTO(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/fournisseur.html.twig', [            'test'=>'mto',            'produits' => $this->getDoctrine()->getRepository(Produits::class)->findByFournisseur(1),            'circuits' => $this->getDoctrine()->getRepository(Produits::class)->findByFourPres(1, 1),            'sejours' => $this->getDoctrine()->getRepository(Produits::class)->findByFourPres(1, 2),            'weekends' => $this->getDoctrine()->getRepository(Produits::class)->findByFourPres(1, 3)        ]);    }    /**     * @Route("/PTO/Portugal", name="Portugal_PTO", methods={"GET"})     *     */    public function fecthPortugal(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/destination.html.twig', [            'test'=>'pto',            'circuits' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(1, 2, 3),            'sejours' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(2, 2, 3),            'weekends' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(3, 2, 3)        ]);    }    /**     * @Route("/PTO/CapVert", name="CapVert_PTO", methods={"GET"})     *     */    public function fecthCapVert(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/destination.html.twig', [            'test'=>'pto',            'circuits' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(1, 2, 4),            'sejours' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(2, 2, 4),            'weekends' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(3, 2, 4)        ]);    }    /**     * @Route("/PTO/Madere", name="Madere_PTO", methods={"GET"})     *     */    public function fecthMadere(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/destination.html.twig', [            'test'=>'pto',            'circuits' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(1, 2, 5),            'sejours' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(2, 2, 5),            'weekends' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(3, 2, 5)        ]);    }    /**     * @Route("/PTO/PortugalSejour", name="Portugal_Sejour_PTO", methods={"GET"})     *     */    public function fecthPS(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/destination.html.twig', [            'test'=>'pto',            'circuits'=>'',            'sejours' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(2, 2, 3),            'weekends' =>''        ]);    }    /**     * @Route("/PTO/PortugalCircuit", name="Portugal_Circuit_PTO", methods={"GET"})     *     */    public function fecth12(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/destination.html.twig', [            'test'=>'pto',            'circuits' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(2, 2, 3),            'weekends' =>'',            'sejours' =>''        ]);    }    /**     * @Route("/PTO/PortugalWeekEnd", name="Portugal_WE_PTO", methods={"GET"})     *     */    public function fecth3(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/destination.html.twig', [            'test'=>'pto',            'weekends' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(3, 2, 3),            'sejours' =>'',            'circuits'=>''        ]);    }    /**     * @Route("/PTO/CapVertWeekEnd", name="CapVert_WE_PTO", methods={"GET"})     *     */    public function fecth4(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/destination.html.twig', [            'test'=>'pto',            'weekends' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(3, 2, 4),            'sejours' =>'',            'circuits'=>''        ]);    }    /**     * @Route("/PTO/CapVertCircuit", name="CapVert_Circuit_PTO", methods={"GET"})     *     */    public function fecth5(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/destination.html.twig', [            'test'=>'pto',            'circuits' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(1, 2, 4),            'sejours' =>'',            'weekends' =>''        ]);    }    /**     * @Route("/PTO/CapVertSejour", name="CapVert_Sejour_PTO", methods={"GET"})     *     */    public function fecth6(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/destination.html.twig', [            'test'=>'pto',            'sejours' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(2, 2, 4),            'weekends' =>'',            'circuits' =>''        ]);    }    /**     * @Route("/PTO/MadereWeekEnd", name="Madere_WE_PTO", methods={"GET"})     *     */    public function fecth7(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/destination.html.twig', [            'test'=>'pto',            'weekends' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(3, 2, 5),            'circuits' =>'',            'sejours' =>''        ]);    }    /**     * @Route("/PTO/MadereCircuit", name="Madere_Circuit_PTO", methods={"GET"})     *     */    public function fecth8(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/destination.html.twig', [            'test'=>'pto',            'circuits' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(1, 2, 5),            'weekends' =>'',            'sejours' =>''        ]);    }    /**     * @Route("/PTO/MadereSejour", name="Madere_Sejour_PTO", methods={"GET"})     *     */    public function fecth9(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/PTO.html.twig', [            'test'=>'pto',            'sejours' => $this->getDoctrine()->getRepository(Produits::class)->findByPFP(2, 2, 5),            'circuits'=>'',            'weekends' =>''        ]);    }    public function fecth11(ProduitsRepository $produitsRepository): Response    {        return $this->render('produits/image.html.twig', [            'produits' => $produitsRepository->findBy(['fournisseur']),            'circuits'=>'',            'weekends'=>''            //'pto' => $this->fetchPTO()        ]);    }}